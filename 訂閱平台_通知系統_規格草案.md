# 訂閱平台通知系統 - 功能規格草案

## 目標
- 追蹤每個訂閱平台的付款方式與下一次扣款日
- 在到期前 7 天 / 3 天 / 當天，分別寄出 Email 提醒
- 記錄每次實際扣款的時間與金額，方便回查

## 核心規則（你已確認）
- 每個平台只會有一種付款型態：月繳或年繳
- 付款型態只會在你手動修改時變更
- 起始日（日期 年繳/月繳）是第一次訂閱開始時間
- 下一次扣款日：
  - 月繳：每個月同日
  - 年繳：每年同日
  - 若當月沒有該日（例如 31 號遇到 2 月），以該月最後一天為扣款日，並保留「原始日為 31」的備註
- 通知時區：台灣
- 通知寄送時間：由你自行設定
- 通知頻率：同一筆訂閱在 7 天 / 3 天 / 當天各寄一封
- 付款狀態：在扣款時間過後，由你手動更新為「已繳費 / 已過期」

## 資料結構（建議欄位）

### 訂閱平台（Subscription）
- 平台名稱
- 付款型態：月繳 / 年繳
- 起始訂閱日（年繳/月繳）：YYYY/MM/DD
- 付款狀態：已繳費 / 已過期
- 金額
- 幣別：TWD / USD
- 扣款方式：信用卡 / 金融卡 / 轉帳 / 現金 / Apple Pay / Google Pay
- 備註（例如：原始日為 31 號）

### 扣款紀錄（Payment History）
- 平台名稱
- 實際扣款日：YYYY/MM/DD
- 金額
- 幣別
- 扣款方式
- 其他備註

### 系統設定（Settings）
- 通知寄送時間（例如：09:00）
- Email 收件人（預設你的 Gmail）

## 通知流程（Email）
1) 系統每日在設定時間觸發排程
2) 取得所有訂閱資料並計算「下一次扣款日」
3) 若今日距離扣款日為：
   - 7 天 → 寄提醒
   - 3 天 → 寄提醒
   - 0 天 → 寄提醒
4) Email 內容格式建議包含：
   - 平台名稱
   - 付款型態（月繳/年繳）
   - 扣款方式
   - 金額與幣別
   - 下一次扣款日
   - 距離扣款日還有幾天

## 待確認 / 下一步
- 是否需要支援多收件人 Email
- 是否要加上「自動判斷已繳費」的機制
- 後續是否要擴充 Line / 手機推播

